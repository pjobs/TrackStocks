<div style="padding: 32px">
  <form (ngSubmit)="onSubmit()" [formGroup]="form">
    <div class="pv-edit-table-container mat-elevation-z8">
      <table mat-table matSort #table [dataSource]="sortedDS">
        <ng-container *ngFor="let name of columnNames"  [matColumnDef]="name">
          <mat-header-cell *matHeaderCellDef mat-sort-header> {{columns[name]?.displayName}} </mat-header-cell>
          <mat-cell *matCellDef="let row"> 
            <span *ngIf="!row.inEditMode && name !=='action'">{{row[name]}}</span>
            <span *ngIf="row.inEditMode && name !=='action'">
              <fw-dynamic-field [field]="columns[name]?.field" 
                [form]="form" 
                [operation]="'edit'" 
                [submitted]="submitted">
              </fw-dynamic-field>
            </span>
            <span *ngIf="row.inEditMode && name ==='action'">
                <button class="mdc-icon-button material-icons" (click)="updateRow(row)">check</button>
                <button class="mdc-icon-button material-icons" (click)="onBlur(row)">close</button>
            </span>
            <span *ngIf="!row.inEditMode && name ==='action'">
                <button class="mdc-icon-button material-icons">edit</button>
            </span>
          </mat-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="columnNames"></mat-header-row>
        <mat-row *matRowDef="let row; columns: columnNames" (click)='editRow(row)' (blur)='onBlur(row)'>
        </mat-row>
      </table>
      <mat-toolbar>
          <mat-toolbar-row>
              <button [disabled]="!form.valid" class="mdc-icon-button material-icons" (click)="addNew()">add</button>
            <span class="toolbar-spacer"></span>
            <mat-paginator [pageSizeOptions]="[5, 10, 20, 100]" showFirstLastButtons></mat-paginator>
          </mat-toolbar-row>
        </mat-toolbar>
      
    </div>
  </form>
</div>